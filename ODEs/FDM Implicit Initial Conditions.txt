//finite difference method with implicit initial conditions 
//SHM
n2=1000
n=n2-2
a=1
b=1
x=linspace(0,2*%pi,n2)
x(1,n2)=[]
x(1,1)=[]
w=1
dx=x(2)-x(1)
s=2-(w*dx)^2
//disp(x)
//disp(s)
A=zeros(n,n)
for i=1:n-1
    A(i,i)=s
    A(i,i+1)=-1
    A(i+1,i)=-1
end
A(n,n)=s
//disp(A)
B=zeros(n,1)
B(1,1)=a
B(n,1)=b
//disp(B)
y=A\B
//disp(y)
plot(x,y)
xgrid
